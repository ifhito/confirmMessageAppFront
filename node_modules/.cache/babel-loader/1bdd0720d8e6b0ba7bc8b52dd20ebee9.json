{"ast":null,"code":"import _slicedToArray from \"/Users/a.seki/Documents/twitter_post/tweet-ref/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/a.seki/Documents/twitter_post/tweet-ref/src/App.js\";\nimport React from 'react';\nimport './App.css';\nimport { useState, useEffect, useContext, createContext } from 'react'; // const accessOauth = () => {\n//   return <button onClick={handleClick}>連携アプリ認証</button>;\n// };\n\nconst InputForm = () => {\n  const ws = new WebSocket('ws://localhost:5000/pipe');\n\n  const _useState = useState(''),\n        _useState2 = _slicedToArray(_useState, 2),\n        name = _useState2[0],\n        setName = _useState2[1];\n\n  const _useState3 = useState(''),\n        _useState4 = _slicedToArray(_useState3, 2),\n        message = _useState4[0],\n        setMessage = _useState4[1];\n\n  const _useState5 = useState(''),\n        _useState6 = _slicedToArray(_useState5, 2),\n        count = _useState6[0],\n        setCount = _useState6[1];\n\n  const handleChange = event => {\n    switch (event.target.name) {\n      case 'name':\n        setName(event.target.value);\n        break;\n\n      case 'message':\n        setMessage(event.target.value);\n        break;\n\n      case 'count':\n        setCount(event.target.value);\n        break;\n\n      default:\n        console.log('key not found');\n    }\n  };\n\n  const handleSubmit = event => {\n    //url無いの特定の要素を持ってくるためのコード(コピペ)\n    const getParam = (name, url) => {\n      if (!url) url = window.location.href;\n      name = name.replace(/[\\[\\]]/g, '\\\\$&');\n      var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\n          results = regex.exec(url);\n      if (!results) return null;\n      if (!results[2]) return '';\n      return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n    };\n\n    event.preventDefault();\n    const envelope = {\n      name: name,\n      message: message,\n      count: count,\n      oauth_token: getParam('oauth_token'),\n      oauth_verifier: getParam('oauth_verifier')\n    };\n    ws.send(JSON.stringify(envelope));\n    console.log(name);\n  };\n\n  return React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }, \"Name:\", React.createElement(\"input\", {\n    type: \"text\",\n    name: \"name\",\n    value: name,\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  })), React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, \"Message:\", React.createElement(\"input\", {\n    type: \"text\",\n    name: \"message\",\n    value: message,\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  })), React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }, \"Count:\", React.createElement(\"input\", {\n    type: \"text\",\n    name: \"count\",\n    value: count,\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  })), React.createElement(\"input\", {\n    type: \"submit\",\n    value: \"Submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }));\n};\n\nconst AccessOauth = () => {\n  const ws = new WebSocket('ws://localhost:5000/pipe');\n\n  const _useState7 = useState(''),\n        _useState8 = _slicedToArray(_useState7, 2),\n        userData = _useState8[0],\n        setUserData = _useState8[1];\n\n  const _useState9 = useState(''),\n        _useState10 = _slicedToArray(_useState9, 2),\n        data = _useState10[0],\n        setData = _useState10[1];\n\n  const _useState11 = useState(''),\n        _useState12 = _slicedToArray(_useState11, 2),\n        error = _useState12[0],\n        setError = _useState12[1]; // サーバー側からメッセージが送られてきた際に受け取り、関数を発動する(Twitterの認証用URLに飛ぶため)\n\n\n  ws.onmessage = e => {\n    console.log(e);\n\n    if (e.data.includes('oauth_token')) {\n      window.location.href = e.data;\n    } else if (e.data == error) {\n      setError('この名前は登録されています');\n    } else {\n      console.log(e);\n      setData(e.data);\n    }\n  }; //クリックした時(今回は文字をbuttonをクリックしたらサーバーにTwitterのもじが送られる)\n\n\n  const handleClick = () => {\n    console.log('rest');\n    ws.send('Twitter');\n  };\n\n  return React.createElement(React.Fragment, null, React.createElement(\"button\", {\n    onClick: handleClick,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, \"Twitter\\u8A8D\\u8A3C\"), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, error));\n};\n\nfunction App() {\n  const _useState13 = useState(false),\n        _useState14 = _slicedToArray(_useState13, 2),\n        flag = _useState14[0],\n        setFlag = _useState14[1];\n\n  const _useState15 = useState(),\n        _useState16 = _slicedToArray(_useState15, 2),\n        render = _useState16[0],\n        setRender = _useState16[1]; // webSocketとの通信;\n  // レンダー前にwsがopenした後にurl内のverifierを返す;\n\n\n  useEffect(() => {\n    if (window.location.search.includes('verifier')) {\n      setRender(React.createElement(InputForm, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      })); //サーバへ送信\n      // ws.send(JSON.stringify(envelope));\n    }\n  }); // //レンダー要素の切替\n  // let render = flag ? <InputForm /> : <AccessOauth />;\n\n  return render;\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/a.seki/Documents/twitter_post/tweet-ref/src/App.js"],"names":["React","useState","useEffect","useContext","createContext","InputForm","ws","WebSocket","name","setName","message","setMessage","count","setCount","handleChange","event","target","value","console","log","handleSubmit","getParam","url","window","location","href","replace","regex","RegExp","results","exec","decodeURIComponent","preventDefault","envelope","oauth_token","oauth_verifier","send","JSON","stringify","AccessOauth","userData","setUserData","data","setData","error","setError","onmessage","e","includes","handleClick","App","flag","setFlag","render","setRender","search"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './App.css';\nimport { useState, useEffect, useContext, createContext } from 'react';\n\n// const accessOauth = () => {\n//   return <button onClick={handleClick}>連携アプリ認証</button>;\n// };\nconst InputForm = () => {\n  const ws = new WebSocket('ws://localhost:5000/pipe');\n  const [name, setName] = useState('');\n  const [message, setMessage] = useState('');\n  const [count, setCount] = useState('');\n\n  const handleChange = event => {\n    switch (event.target.name) {\n      case 'name':\n        setName(event.target.value);\n        break;\n      case 'message':\n        setMessage(event.target.value);\n        break;\n      case 'count':\n        setCount(event.target.value);\n        break;\n      default:\n        console.log('key not found');\n    }\n  };\n  const handleSubmit = event => {\n    //url無いの特定の要素を持ってくるためのコード(コピペ)\n    const getParam = (name, url) => {\n      if (!url) url = window.location.href;\n      name = name.replace(/[\\[\\]]/g, '\\\\$&');\n      var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\n        results = regex.exec(url);\n      if (!results) return null;\n      if (!results[2]) return '';\n      return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n    };\n    event.preventDefault();\n    const envelope = {\n      name: name,\n      message: message,\n      count: count,\n      oauth_token: getParam('oauth_token'),\n      oauth_verifier: getParam('oauth_verifier')\n    };\n    ws.send(JSON.stringify(envelope));\n    console.log(name);\n  };\n  return (\n    <form onSubmit={handleSubmit}>\n      <label>\n        Name:\n        <input type=\"text\" name=\"name\" value={name} onChange={handleChange} />\n      </label>\n      <label>\n        Message:\n        <input\n          type=\"text\"\n          name=\"message\"\n          value={message}\n          onChange={handleChange}\n        />\n      </label>\n      <label>\n        Count:\n        <input type=\"text\" name=\"count\" value={count} onChange={handleChange} />\n      </label>\n      <input type=\"submit\" value=\"Submit\" />\n    </form>\n  );\n};\n\nconst AccessOauth = () => {\n  const ws = new WebSocket('ws://localhost:5000/pipe');\n  const [userData, setUserData] = useState('');\n  const [data, setData] = useState('');\n  const [error, setError] = useState('');\n  // サーバー側からメッセージが送られてきた際に受け取り、関数を発動する(Twitterの認証用URLに飛ぶため)\n  ws.onmessage = e => {\n    console.log(e);\n    if (e.data.includes('oauth_token')) {\n      window.location.href = e.data;\n    } else if (e.data == error) {\n      setError('この名前は登録されています');\n    } else {\n      console.log(e);\n      setData(e.data);\n    }\n  };\n  //クリックした時(今回は文字をbuttonをクリックしたらサーバーにTwitterのもじが送られる)\n  const handleClick = () => {\n    console.log('rest');\n    ws.send('Twitter');\n  };\n  return (\n    <>\n      <button onClick={handleClick}>Twitter認証</button>\n      <div>{error}</div>\n    </>\n  );\n};\n\nfunction App() {\n  const [flag, setFlag] = useState(false);\n  const [render, setRender] = useState();\n  // webSocketとの通信;\n  // レンダー前にwsがopenした後にurl内のverifierを返す;\n  useEffect(() => {\n    if (window.location.search.includes('verifier')) {\n      setRender(<InputForm />);\n      //サーバへ送信\n      // ws.send(JSON.stringify(envelope));\n    }\n  });\n\n  // //レンダー要素の切替\n  // let render = flag ? <InputForm /> : <AccessOauth />;\n  return render;\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}