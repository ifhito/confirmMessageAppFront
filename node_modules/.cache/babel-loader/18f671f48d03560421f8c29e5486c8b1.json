{"ast":null,"code":"import _slicedToArray from \"/Users/a.seki/Documents/twitter_post/tweet-ref/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/a.seki/Documents/twitter_post/tweet-ref/src/App.js\";\nimport React from 'react';\nimport logo from \"./logo.svg\";\nimport './App.css';\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nfunction App() {\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        flag = _useState2[0],\n        setFlag = _useState2[1];\n\n  const ws = new WebSocket('ws://localhost:5000/pipe'); // constructor(props){\n  //   super(props)\n  //   this.state = {\n  //     showFlag: false\n  //   }\n  // }\n\n  ws.onopen = function (event) {\n    if (window.location.search.includes('verifier')) {\n      setFlag(true);\n      ws.send(getParam('oauth_verifier'));\n    }\n  };\n\n  function getParam(name, url) {\n    if (!url) url = window.location.href;\n    name = name.replace(/[\\[\\]]/g, '\\\\$&');\n    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\n        results = regex.exec(url);\n    if (!results) return null;\n    if (!results[2]) return '';\n    return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n  }\n\n  let userData = '';\n\n  ws.onmessage = function (e) {\n    console.log(e);\n\n    if (e.data.includes('oauth_token')) {\n      window.location.href = e.data;\n    }\n  };\n\n  function handleClick() {\n    console.log('rest');\n    ws.send('Twitter');\n  }\n\n  let render = flag ? React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47\n    },\n    __self: this\n  }, userData) : React.createElement(\"button\", {\n    onClick: handleClick,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }, \"\\u9023\\u643A\\u30A2\\u30D7\\u30EA\\u8A8D\\u8A3C\"); // useEffect(async () => {\n  //   const result = await axios('https://cee83dd0.ngrok.io/twitter_auth');\n  //   windowLogin = window.open(result.data.url);\n  //   // setTimeout(function(){CheckLoginStatusTwitter(history)}, 1000)\n  //   const xx = windowLogin.focus();\n  //   console.log(xx);\n  //   // setData(result);\n  // });\n\n  return React.createElement(React.Fragment, null, render);\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/a.seki/Documents/twitter_post/tweet-ref/src/App.js"],"names":["React","useState","useEffect","axios","App","flag","setFlag","ws","WebSocket","onopen","event","window","location","search","includes","send","getParam","name","url","href","replace","regex","RegExp","results","exec","decodeURIComponent","userData","onmessage","e","console","log","data","handleClick","render"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;;AAEA,OAAO,WAAP;AACA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,SAASC,GAAT,GAAe;AAAA,oBACWH,QAAQ,CAAC,KAAD,CADnB;AAAA;AAAA,QACNI,IADM;AAAA,QACAC,OADA;;AAEb,QAAMC,EAAE,GAAG,IAAIC,SAAJ,CAAc,0BAAd,CAAX,CAFa,CAGb;AACA;AACA;AACA;AACA;AACA;;AAEAD,EAAAA,EAAE,CAACE,MAAH,GAAY,UAASC,KAAT,EAAgB;AAC1B,QAAIC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuBC,QAAvB,CAAgC,UAAhC,CAAJ,EAAiD;AAC/CR,MAAAA,OAAO,CAAC,IAAD,CAAP;AACAC,MAAAA,EAAE,CAACQ,IAAH,CAAQC,QAAQ,CAAC,gBAAD,CAAhB;AACD;AACF,GALD;;AAMA,WAASA,QAAT,CAAkBC,IAAlB,EAAwBC,GAAxB,EAA6B;AAC3B,QAAI,CAACA,GAAL,EAAUA,GAAG,GAAGP,MAAM,CAACC,QAAP,CAAgBO,IAAtB;AACVF,IAAAA,IAAI,GAAGA,IAAI,CAACG,OAAL,CAAa,SAAb,EAAwB,MAAxB,CAAP;AACA,QAAIC,KAAK,GAAG,IAAIC,MAAJ,CAAW,SAASL,IAAT,GAAgB,mBAA3B,CAAZ;AAAA,QACEM,OAAO,GAAGF,KAAK,CAACG,IAAN,CAAWN,GAAX,CADZ;AAEA,QAAI,CAACK,OAAL,EAAc,OAAO,IAAP;AACd,QAAI,CAACA,OAAO,CAAC,CAAD,CAAZ,EAAiB,OAAO,EAAP;AACjB,WAAOE,kBAAkB,CAACF,OAAO,CAAC,CAAD,CAAP,CAAWH,OAAX,CAAmB,KAAnB,EAA0B,GAA1B,CAAD,CAAzB;AACD;;AAED,MAAIM,QAAQ,GAAG,EAAf;;AACAnB,EAAAA,EAAE,CAACoB,SAAH,GAAe,UAASC,CAAT,EAAY;AACzBC,IAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;;AACA,QAAIA,CAAC,CAACG,IAAF,CAAOjB,QAAP,CAAgB,aAAhB,CAAJ,EAAoC;AAClCH,MAAAA,MAAM,CAACC,QAAP,CAAgBO,IAAhB,GAAuBS,CAAC,CAACG,IAAzB;AACD;AACF,GALD;;AAOA,WAASC,WAAT,GAAuB;AACrBH,IAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACAvB,IAAAA,EAAE,CAACQ,IAAH,CAAQ,SAAR;AACD;;AAED,MAAIkB,MAAM,GAAG5B,IAAI,GACf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAMqB,QAAN,CADe,GAGf;AAAQ,IAAA,OAAO,EAAEM,WAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kDAHF,CAvCa,CA4Cb;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;;AACA,SAAO,0CAAGC,MAAH,CAAP;AACD;;AAED,eAAe7B,GAAf","sourcesContent":["import React from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nfunction App() {\n  const [flag, setFlag] = useState(false);\n  const ws = new WebSocket('ws://localhost:5000/pipe');\n  // constructor(props){\n  //   super(props)\n  //   this.state = {\n  //     showFlag: false\n  //   }\n  // }\n\n  ws.onopen = function(event) {\n    if (window.location.search.includes('verifier')) {\n      setFlag(true);\n      ws.send(getParam('oauth_verifier'));\n    }\n  };\n  function getParam(name, url) {\n    if (!url) url = window.location.href;\n    name = name.replace(/[\\[\\]]/g, '\\\\$&');\n    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\n      results = regex.exec(url);\n    if (!results) return null;\n    if (!results[2]) return '';\n    return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n  }\n\n  let userData = '';\n  ws.onmessage = function(e) {\n    console.log(e);\n    if (e.data.includes('oauth_token')) {\n      window.location.href = e.data;\n    }\n  };\n\n  function handleClick() {\n    console.log('rest');\n    ws.send('Twitter');\n  }\n\n  let render = flag ? (\n    <div>{userData}</div>\n  ) : (\n    <button onClick={handleClick}>連携アプリ認証</button>\n  );\n  // useEffect(async () => {\n  //   const result = await axios('https://cee83dd0.ngrok.io/twitter_auth');\n\n  //   windowLogin = window.open(result.data.url);\n  //   // setTimeout(function(){CheckLoginStatusTwitter(history)}, 1000)\n  //   const xx = windowLogin.focus();\n  //   console.log(xx);\n  //   // setData(result);\n  // });\n  return <>{render}</>;\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}